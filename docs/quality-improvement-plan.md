# 代码质量提升路线图

以下方案聚焦于三个维度：Lint 清零、TypeScript 严格化以及教学卡片体验扩展，帮助团队在持续交付迭代中保持质量与体验的同步提升。

## 1. Lint 清零策略

- **目标拆分**：按功能域划分治理批次（例如 `auth`、`subscription`、`cards`、`monitoring`），每个批次在一周内完成新增报错为 0、历史告警净减少的目标。
- **优先级排序**：先处理高风险类别（`react-hooks/*`、`no-alert`、`import/order` 与 `no-console`）再进入风格类规则（`max-len` 等），避免重复返工。
- **工具支持**：为大批量规则准备脚本或 ESLint autofix（如针对 `no-console` 统一改为日志封装）。每次提交要求附带对应模块的 lint 记录截图或命令输出。
- **准入校验**：在 CI 中增加 `npm run lint -- --max-warnings=0` 的试运行通道，确认历史告警消除后再设为强制门槛。

## 2. TypeScript 严格选项恢复计划

- **阶段一（已完成）**：启用 `noFallthroughCasesInSwitch` 与 `forceConsistentCasingInFileNames`，确保分支与大小写一致性已经由编译器兜底。
- **阶段二**：在 `auth` 与 `cards` 模块先行开启 `noUnusedLocals`、`noUnusedParameters`，结合 lint 去除遗留未使用变量。
- **阶段三**：逐模块引入 `strictNullChecks` 与 `noImplicitAny`，配合类型补充与防御性编码；治理策略是先补齐核心接口（登录、生成卡片、分享导出）再扩散到长尾模块。
- **阶段四**：最终全局打开 `strict`、`alwaysStrict`，同步更新测试与 mocks 的类型定义，完成 strict mode 的闭环。
- **追踪机制**：建立 `type-check.log` 的周度归档，记录开启选项与剩余错误数，保障每阶段输出可验证。

## 3. 教学卡片体验增强与导出落地概述

- **SOP 提示层**：为生成结果中的关键卡片节点新增操作化提示（目标、互动形式、板书要点等），以结构化 JSON 形式落库，前端展示为折叠面板。
- **演示模式**：在桌面端创作页提供“投屏视图”，支持激光笔高亮与卡片逐项播放；交互上保持键盘左右键或遥控器式控制，契合实体课堂节奏。
- **导出 / 分享流程**：统一通过 `ExportSharePanel` 对接下载（PDF/图片）与链接分享，后端新增 webhook 记录导出行为；跨端一致性以“导出为演示文件”为第一优先，后续再评估打印方案。
- **验证节点**：每项体验迭代需配套可执行的自测清单（包含登录态、生成、演示与导出链路），并在发布前完成一次端到端回归。

## 4. 后续动作

1. 建立 Lint 债务看板，定义每周治理文件清单。
2. 选择一个核心模块试点严格类型选项，记录修复成本并沉淀规范范式。
3. 为演示模式与导出流程编写需求草案及接口契约，确保前后端同步开发。
4. 将上述计划纳入迭代节奏，在评审会上追踪完成度与阻塞点。

如需扩展，请在 `docs/` 目录下补充对应模块的落地细则。
